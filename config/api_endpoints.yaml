# =============================================================================
# BESS Site Scout — API Endpoints Reference
# All endpoints are free/public unless noted
# =============================================================================

hifld:
  # Electric Substations
  substations:
    base_url: "https://services1.arcgis.com/Hp6G80Pky0om6HgQ/arcgis/rest/services/Electric_Substations/FeatureServer/0"
    query_path: "/query"
    format: "geojson"
    # Key fields: NAME, CITY, STATE, ZIP, TYPE, STATUS, OWNER, MAX_VOLT, MIN_VOLT, LATITUDE, LONGITUDE
    # VOLT_CLASS values: "UNDER 100", "100-161", "220-287", "345", "500", "735 AND ABOVE", "NOT AVAILABLE"
    notes: "May require ArcGIS account for bulk download; API queries work without auth"

  # Electric Power Transmission Lines
  transmission_lines:
    base_url: "https://services1.arcgis.com/Hp6G80Pky0om6HgQ/arcgis/rest/services/Electric_Power_Transmission_Lines/FeatureServer/0"
    query_path: "/query"
    format: "geojson"
    # Key fields: OWNER, VOLTAGE, VOLT_CLASS, SUB_1, SUB_2, STATUS, SHAPE_Length
    # VOLT_CLASS: "UNDER 100", "100-161", "220-287", "345", "500", "735 AND ABOVE", "DC", "NOT AVAILABLE"

fema:
  # National Flood Hazard Layer
  nfhl:
    base_url: "https://hazards.fema.gov/gis/nfhl/rest/services/public/NFHL/MapServer"
    flood_zones_layer: 28  # S_Fld_Haz_Ar — Flood Hazard Zones
    query_path: "/28/query"
    format: "geojson"
    # Key fields: FLD_ZONE, ZONE_SUBTY, SFHA_TF, STATIC_BFE
    # FLD_ZONE values: A, AE, AH, AO, AR, V, VE, X (unshaded), X (shaded), D

epa:
  # Envirofacts Data Service API
  envirofacts:
    base_url: "https://enviro.epa.gov/enviro/efservice"
    # Table query format: /{program}.{table}/{column}/{operator}/{value}/{format}
    # Example: /sems.sems_active_sites/state_code/TX/json
    programs:
      sems: "sems.sems_active_sites"           # Superfund/NPL
      rcra_tsd: "rcrainfo.rcra_br_lu_subpart"   # RCRA TSD facilities
      rcra_gen: "rcrainfo.rcra_handler"          # RCRA generators
      tri: "tris.tri_facility"                   # Toxic Release Inventory
      brownfields: "acres.acres_site_info"       # Brownfields/ACRES

  # ECHO — Enforcement & Compliance
  echo:
    base_url: "https://echo.epa.gov/api"
    facilities_path: "/echo_rest_services.get_facilities"
    # Params: p_st=TX, p_lat, p_long, p_radius (miles)
    format: "json"

  # Facility Registry Service (for lat/long lookups)
  frs:
    base_url: "https://enviro.epa.gov/enviro/efservice/frs.frs_program_facility"
    format: "json"

tceq:
  # TCEQ GIS Data Hub (ArcGIS Online)
  gis_hub_base: "https://gis-tceq.opendata.arcgis.com"

  # Leaking Petroleum Storage Tanks
  lpst:
    base_url: "https://services.arcgis.com/KTcxiTD9dsQw4r7Z/arcgis/rest/services/LPST_Points/FeatureServer/0"
    query_path: "/query"
    format: "geojson"

  # Petroleum Storage Tanks (UST/AST)
  pst:
    base_url: "https://services.arcgis.com/KTcxiTD9dsQw4r7Z/arcgis/rest/services/PetroleumStorageTanks/FeatureServer/0"
    query_path: "/query"
    format: "geojson"

  # Industrial & Hazardous Waste
  ihw:
    base_url: "https://services.arcgis.com/KTcxiTD9dsQw4r7Z/arcgis/rest/services"
    notes: "Check TCEQ GIS Hub for current service name"

  # Municipal Solid Waste
  msw:
    base_url: "https://services.arcgis.com/KTcxiTD9dsQw4r7Z/arcgis/rest/services"
    notes: "Check TCEQ GIS Hub for current service name"

  # Groundwater Contamination
  groundwater:
    notes: "Available through TCEQ GIS viewers — may need to scrape or use ArcGIS services"

  # Raw data downloads (CSV/Excel)
  raw_downloads:
    pst_data: "https://www.tceq.texas.gov/agency/data/lookup-data/pst-datasets-records.html"
    ihw_data: "https://www.tceq.texas.gov/agency/data/lookup-data/download-data.html"
    spills_data: "https://www.tceq.texas.gov/agency/data/lookup-data/download-data.html"

usfws:
  # National Wetlands Inventory
  nwi:
    rest_service: "https://fwspublicservices.wim.usgs.gov/wetlandsmapservice/rest/services/Wetlands/MapServer"
    wetlands_layer: 0
    query_path: "/0/query"
    wms_url: "https://fwspublicservices.wim.usgs.gov/wetlandsmapservice/services/Wetlands/MapServer/WMSServer"
    download_by_state: "https://www.fws.gov/program/national-wetlands-inventory/download-state-wetlands-data"
    format: "geojson"

  # Critical Habitat for Threatened & Endangered Species
  critical_habitat:
    base_url: "https://services.arcgis.com/QVENGdaPbd4LUkLV/arcgis/rest/services/FWS_HQ_ES_Critical_Habitat/FeatureServer/0"
    query_path: "/query"
    format: "geojson"

rrc:
  # Texas Railroad Commission — Oil & Gas
  # Note: RRC GIS data is primarily through their viewer; API access is limited
  gis_viewer: "https://www.rrc.texas.gov/resource-center/research/gis-viewer/"
  # Well data can be downloaded in bulk
  well_data: "https://www.rrc.texas.gov/resource-center/research/data-sets-available-for-download/"
  notes: "May need to download bulk datasets and filter locally"

usda:
  # Web Soil Survey
  soil_survey:
    base_url: "https://SDMDataAccess.sc.egov.usda.gov/Tabular/SDMTabularService/post.rest"
    wms_url: "https://SDMDataAccess.sc.egov.usda.gov/Spatial/SDM.wms"
    format: "json"

eia:
  # US Energy Atlas (validation layer — same HIFLD data)
  energy_atlas:
    base_url: "https://services7.arcgis.com/FGr1D95XCGALKXqM/arcgis/rest/services"
    transmission_lines: "/Electric_Power_Transmission_Lines/FeatureServer/0"
    power_plants: "/Power_Plants/FeatureServer/0"

ercot:
  # ERCOT data products
  maps: "https://www.ercot.com/news/mediakit/maps"
  grid_info: "https://www.ercot.com/gridinfo"
  transmission: "https://www.ercot.com/gridinfo/transmission"
  gis_report: "https://www.ercot.com/mp/data-products/data-product-details?id=PG7-200-ER"
  notes: "GIS report requires MIS login; public maps available without auth"

# --- ArcGIS Query Patterns ---
# Most HIFLD/FEMA/TCEQ/USFWS endpoints use the same ArcGIS REST query pattern:
#
# GET {base_url}/query?
#   where=STATE='TX' AND VOLT_CLASS='345'
#   &outFields=*
#   &geometry={xmin},{ymin},{xmax},{ymax}
#   &geometryType=esriGeometryEnvelope
#   &spatialRel=esriSpatialRelIntersects
#   &f=geojson
#   &resultRecordCount=1000
#   &resultOffset=0
#
# For point-radius queries:
#   &geometry={lon},{lat}
#   &geometryType=esriGeometryPoint
#   &distance={radius_meters}
#   &units=esriSRUnit_Meter
#   &spatialRel=esriSpatialRelIntersects
